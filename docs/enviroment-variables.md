# Environment Variables

In the following you can find all the environment variables used in the TruBudget project. Use this list as reference for development and deployment.

| Project        | Shortcut |
| -------------- | -------- |
| Frontend       | ui       |
| API            | api      |
| Blockchain     | bc       |
| Provisioning   | prov     |
| Docker-compose | dc       |

| Env Variable                  | Required | Default Value | Used by                             | Description                                                                                                                                                                                                                                                                                                                                                                                     |
| ----------------------------- | -------- | ------------- | ----------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ORGANIZATION                  | yes      | -             | bc/api                              | In the blockchain network, each node is represented by its organization name. This environment variable sets this organization name. It is used to create the organization stream on the blockchain and is also displayed in the frontend's top right corner.                                                                                                                                   |
| ORGANIZATION_VAULT_SECRET     | yes      | -             | api                                 | This is the key to en-/decrypt user data of an organization. If you want to add a new node for your organization, you want users to be able to log in on either node. Make sure that the api connected to the new node has the same organization vault secret.<br/>**Caution:** If you want to run TruBudget in production,make sure NOT to use the default value from the `.env_example` file! |
| API_HOST                      | no       |               | bc/prov                             | The IP address of one api which is connected to the node you want to connect to (The IP addresses are usually the same as for the P2P host address).                                                                                                                                                                                                                                            |
| API_PORT                      | no       | 8080          | bc/prov                             | The port used to connect to the api.                                                                                                                                                                                                                                                                                                                                                            |
| JWT_SECRET                    | no       | [random]      | api/bc                              | A string that is used to sign JWT which are created by the authenticate endpoint of the api                                                                                                                                                                                                                                                                                                     |
| P2P_HOST                      | no       |               | bc                                  | The IP address of the blockchain node you want to connect to.                                                                                                                                                                                                                                                                                                                                   |
| P2P_PORT                      | no       | 7447          | bc                                  | The port on which the node you want to connect to has exposed the blockchain.                                                                                                                                                                                                                                                                                                                   |
| PORT                          | no       | 8080          | api                                 | The port used to expose the API for your installation. Example: If you run TruBudget locally and set API_PORT to `8080`, you can reach the API via `localhost:8080/api`.                                                                                                                                                                                                                        |
| ROOT_SECRET                   | no       | [random]      | api                                 | The root secret is the password for the root user. If you start with an empty blockchain, the root user is needed to add other users, approve new nodes,.. If you don't set a value via the environment variable, the API generates one randomly and prints it to the console<br/>**Caution:** If you want to run TruBudget in production, make sure to set a secure root secret.               |
| RPC_PASSWORD                  | no       | [hardcoded]   | api/bc                              | Password used by the API to connect to the blockchain. The password is set by the origin node upon start. Every slave node needs to use the same RPC password in order to be able to connect to the blockchain.<br/>**Hint:** Although the RPC_PASSWORD is not required it is highly recommended to set an own secure one                                                                       |
| RPC_PORT                      | no       | 8000          | api/bc                              | The port used to expose the multichain daemon of your Trubudget blockchain installation(bc). The port used to connect to the multichain daemon(api). This will be used internally for the communication between the API and the multichain daemon.                                                                                                                                              |
| RPC_USER                      | no       | multichainrpc | api/bc                              | The user used to connect to the multichain daemon.                                                                                                                                                                                                                                                                                                                                              |
| EXTERNAL_IP                   | no       |               | bc                                  | The IP address with which the current node can be reached. Example: If you have a VM running on 52.52.52.52 and you want to start a slave node from this VM to connect to a master running on 53.53.53.53, you set the `EXTERNAL_IP` to 52.52.52.52 on this node.                                                                                                                               |
| ACCESS_CONTROL_ALLOW_ORIGIN   | no       | "\*"          | bc/api/excel-export/storage-service | Since the services use CORS, the domain by which it can be called needs to be set. Setting this value to `"*"` means that it can be called from any domain. Read more about this topic [here](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS).                                                                                                                                          |
| LOG_LEVEL                     | no       | INFO          | api/bc                              | Sets the lowest level to the pino logger that is printed to `STDOUT` with varying levels ranging from `trace` to `fatal`.                                                                                                                                                                                                                                                                       |
| MULTICHAIN_DIR                | no       | /root         | bc                                  | The path to the multichain folder where the blockchain data is persisted. For installations via `docker-compose`, this refers to the path within the docker container of the blockchain. For bare metal installations, this refers to the path on the machine the blockchain is running on.                                                                                                     |
| PRETTY_PRINT                  | no       | true          | api/bc                              | Decides whether the logs printed by the API are pretty printed or not. Pretty printed logs are easier to read while non-pretty printed logs are easier to store and use e.g. in the ELK (Elasticsearch-Logstash-Kabana) stack.                                                                                                                                                                  |
| SWAGGER_BASEPATH `deprecated` | no       | /             | api                                 | This variable was used to choose which environment (prod or test) is used for testing the requests. The variable is deprecated now, as the Swagger documentation can be used for the prod and test environment separately.                                                                                                                                                                      |
| TAG                           | no       | master        | dc                                  | The tag defines the version of the image that is pulled from the docker hub.                                                                                                                                                                                                                                                                                                                    |
| NODE_ENV                      | no       |               | ui/api                              | If set to `development` search Trubudget's external services on localhost, api will allow any string as password. If set to `production` disable Redux devtools extension.                                                                                                                                                                                                                      |
| REACT_APP_VERSION             | no       |               | ui                                  | Injected version via `$npm_package_version` in`.env` file to ensure the version is shown in the frontend                                                                                                                                                                                                                                                                                        |
| INLINE_RUNTIME_CHUNK          | no       | false         | frontend                            | Scripts that are injected by React will not be injected inline but as script with src="...". Important for being able to enforce a stricter [Content Security Polify](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP)                                                                                                                                                                    |

#### Kubernetes

| Env Variable | Required | Default Value | Used by | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ------------ | -------- | ------------- | ------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| EXPOSE_MC    | no       | false         | bc      | If set to true Trubudget tries to expose it's multichain via kubernetes' ingress. First a kubernetes config file is searched in `/.kube/config`. If not found and the MC is deployed in a cluster, it is searching for the service account to get the information. After configuration the `externalip` arg is set to the ip of the service' ingress of the configured clusterSERVICE_NAME and NAMESPACE are required to access the ingress of the service. |
| SERVICE_NAME | no       |               | bc      | This variable is only required if EXPOSE_MC is set to true. It defines which service the kubernetes client should search for in the configured kubernetes cluster                                                                                                                                                                                                                                                                                           |
| NAMESPACE    | no       |               | bc      | This variable is only required if EXPOSE_MC is set to true. It defines in which namespace the kubernetes client should search for the given service                                                                                                                                                                                                                                                                                                         |
